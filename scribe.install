post_install() {
    echo "==> Setting up permissions..."
    echo "==> Reloading udev rules..."
    udevadm control --reload-rules
    udevadm trigger

    echo ""
    echo "==> scribe installed successfully!"
    echo ""
    echo "==> Next steps:"
    echo "    1. Add your user to 'input' group:"
    echo "       sudo usermod -aG input \$USER"
    echo ""
    echo "    2. Copy default config:"
    echo "       mkdir -p ~/.config/scribe"
    echo "       cp /usr/share/scribe/default.toml ~/.config/scribe/config.toml"
    echo ""
    echo "    3. Edit config (choose backend: 'local' or 'openai'):"
    echo "       \$EDITOR ~/.config/scribe/config.toml"
    echo ""
    echo "    4. If using OpenAI API backend with systemd service:"
    echo "       a) Create API key file:"
    echo "          echo 'OPENAI_API_KEY=sk-your-key-here' > ~/.config/scribe/api-key.env"
    echo "          chmod 600 ~/.config/scribe/api-key.env"
    echo ""
    echo "       b) Copy and customize systemd service:"
    echo "          mkdir -p ~/.config/systemd/user"
    echo "          cp /usr/lib/systemd/user/scribe.service ~/.config/systemd/user/"
    echo "          # Add this line after [Service]:"
    echo "          # EnvironmentFile=%h/.config/scribe/api-key.env"
    echo ""
    echo "       c) Reload systemd:"
    echo "          systemctl --user daemon-reload"
    echo ""
    echo "    5. Log out and back in (for group change to take effect)"
    echo ""
    echo "    6. Start scribe:"
    echo "       Manual: scribe"
    echo "       Or enable service: systemctl --user enable --now scribe"
    echo ""
    echo "==> For XMonad integration, add to xmonad.hs:"
    echo "    ((mod4Mask, xK_F9), spawn \"scribe toggle\")"
}

post_upgrade() {
    post_install
}
